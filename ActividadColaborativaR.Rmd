---
title: "Ejercicios en R"
author: "Ernesto Miranda"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Ejercicios en R

1. Escribe una función que genere una secuencia aleatoria de DNA de tamaño “n”.
```{r}
n <- readline("Ingresa el tamaño de la secuencia: ")

# Funcion generar la secuencia
generarAdn = function(n){
  bases <- c("A", "T", "C", "G")
  sample(bases, n, TRUE)
}

chain <- generarAdn(n)

```
2. Codifica una función que calcula el tamaño de una secuencia de DNA.
```{r}
# Funcion para calcular el tamaño de la secuencia
sizeDna <- function(chain){
  length(chain)
}
```
3. Crea una función que recibe una secuencia de DNA e imprime el porcentaje de cada base en la 
secuencia.
```{r}
# Funcion para calcular el porcentaje de cada base nitrogenada
percentageBase <- function(chain){
  size <- sizeDna(chain)
  bases <- c("A", "T", "C", "G")
  percentages <- numeric(4)
  for (el in chain) {
    for (i in 1:4){
      if (el == bases[i]) percentages[i] <- percentages[i] + 1
    }
  }
  for (i in 1:4){
    percentages[i] = percentages[i] / size
  }
  percentages
}
percentageBase(chain)
```

4. Programa una función que transcribe DNA a RNA, asume que te proporcionan la cadena codifican.
```{r} 

n <- readline("Número de nucleótidos ATCG: ")

creacion <- function(n){
  dna <- c()
  for (i in 1:n){
    dna[i] <- c(readline("Base:"))
    }
return(dna)
}

transcripcion <- function(dna){
  rna <- c();
  for (i in 1:length(dna)){
    if (dna[i] == "T"){
      rna[i] <- "U"
    }else {
      rna[i] <- dna[i]
    }
  }
  return(rna)
}

dna <- creacion(n)
dna
transcripcion(dna)
```

5. Crea una función que traduce una secuencia de RNA a una secuencia de proteínas, usa la siguiente tabla. 
![Tabla de proteinas](./img/proteinas.png)
```{r}
# Funcion para concatenar la cadena
concat = function(chain){
  clean <- ""
  for(l in chain){
    clean <- paste(clean, l, sep="")
  }
  clean
}

prot = function(codon){
  switch(codon, 
         "UUU" = "Phe", "UUC" = "Phe", "UUA" = "Leu", "UUG" = "Leu", 
         "CUU" = "Leu", "CUC" = "Leu", "CUA" = "Leu", "CUG" = "Leu", 
         "AUU" = "Ile", "AUC" = "Ile", "AUA" = "Ile", "AUG" = "Met", 
         "GUU" = "Val", "GUC" = "Val", "GUA" = "Val", "GUG" = "Val", 
         "UCU" = "Ser", "UCC" = "Ser", "UCA" = "Ser", "UCG" = "Ser", 
         "CCU" = "Pro", "CCC" = "Pro", "CCA" = "Pro", "CCG" = "Pro", 
         "ACU" = "Thr", "ACC" = "Thr", "ACA" = "Thr", "ACG" = "Thr", 
         "GCU" = "Ala", "GCU" = "Ala", "GCA" = "Ala", "GCG" = "Ala", 
         "UAU" = "Tyr", "UAC" = "Tyr", "CAU" = "His", "CAC" = "His", 
         "CAA" = "Gin", "CAG" = "Gin", "AAU" = "Asn", "AAC" = "Asn",
         "AAU" = "Asn", "AAC" = "Asn", "AAA" = "Lys", "AAG" = "Lys",
         "GAU" = "Asp", "GAC" = "Asp", "GAA" = "Glu", "GAG" = "Glu",
         "UGU" = "Cys", "UGC" = "Cys", "CGU" = "Arg", "CGC" = "Arg",
         "CGA" = "Arg", "CGG" = "Arg", "AGU" = "Ser", "AGC" = "Ser",
         "AGA" = "Arg", "AGG" = "Arg", "GGU" = "Gly", "GGC" = "Gly",
         "GGA" = "Gly", "GGG" = "Gly")
}
rnaProt = function(chain){
  
}

rev<-function(l)
{
  r<-c()
  i<-1
  j<-length(l)
  for (i in 1:length(l))
  {
    r[i]<-l[j]
    j<-j-1
  }
  return(r)
}
#Ejercicio 1
n<-readline("Ingrese el tamaño de la secuencia: ")

generar<-function(a)
{
  bases<- c("A","T","C","G")
  dna<-sample(bases,a,replace=TRUE)
  return (dna)
}
dna<-generar(n) # generan al azar
dna
```
```{r}
#Ejercicio 6
n<-readline("Número de nucleótidos ATCG: ")
print("Escribe A T C G o no se tomarán en cuenta")
reverse<-function(n)
{
  l<-c()
  r<-c()
  i<-1
  for (i in 1:n)
  {
    
    a<-readline("Nucleótidos A T C G: ")
    a<-toupper(a)
    if (a=="A"||a=="T"||a=="C"||a=="G")
    {
      l[i]<-a
    }
  }
  rev(l)
}
reverse(n)

# Ejercicio 7
n<-readline("Número de nucleótidos ATCG: ")
comp<-function(n)
{
  l<-c()
  i<-1
  for (i in 1:n)
  {
    a<-readline("Nucleótidos A T C G: ")
    a<-toupper(a)
    if (a=="A")
    {
      l[i]<-"T"
    }
    else if (a=="T")
    {
      l[i]<-"A"
    }
    else if (a=="C")
    {
      l[i]<-"G"
    }
    else if (a=="G")
    {
      l[i]<-"C"
    }
  }
  return (l)
}
comp(n)

# Ejercicio 8

n<-readline("Número de nucleótidos ATCG: ")
a<-comp(n)
rev(a)
```
